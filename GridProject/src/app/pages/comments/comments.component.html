 <div class="container p-3 bg-white">
  <div class="p-4">
    <nz-list [nzDataSource]="data" [nzRenderItem]="item" [nzItemLayout]="'horizontal'">
      <ng-template #item let-item>
        <nz-comment [nzAuthor]="item.author" [nzDatetime]="item.displayTime">
          <nz-avatar nz-comment-avatar nzIcon="user" [nzSrc]="item.avatar"></nz-avatar>
          <nz-comment-content>
            <p>{{ item.comment }}</p>
           @if (item.replies) {
           <div >
            @for (reply of item.replies ;track $index) {
              <nz-comment [nzAuthor]="reply.author" [nzDatetime]="reply.displayTime">
                <nz-avatar nz-comment-avatar nzIcon="user" [nzSrc]="reply.avatar"></nz-avatar>
                <nz-comment-content>
                  <p>{{ reply.comment }}</p>
                </nz-comment-content>
              </nz-comment>
            }
            </div>
          } 
          </nz-comment-content>
          <nz-comment-action>
            <a (click)="item.showReply = !item.showReply">{{ item.showReply ? 'Cancel' : 'Reply' }}</a>
          </nz-comment-action>
        @if (item.showReply) { 
        <div>
            <form nz-form [formGroup]="item.replyForm">
              <nz-form-item>
                <nz-form-control nzErrorTip="Please input your reply!">
                  <textarea formControlName="reply" nz-input class="rounded-md" rows="2"></textarea>
                </nz-form-control>
              </nz-form-item>
              <button nz-button nzType="primary" (click)="handleReply(item)">Add Reply</button>
            </form>
          </div>
        }
        </nz-comment>
      </ng-template>
    </nz-list>
    <form nz-form [formGroup]="commentsForm">
      <nz-comment>
        <nz-avatar nz-comment-avatar nzIcon="user" [nzSrc]="user.avatar"></nz-avatar>
        <nz-comment-content>
          <nz-form-item>
            <nz-form-control nzErrorTip="Please input your comment!">
              <textarea formControlName="comment" nz-input class="rounded-md" rows="4"></textarea>
            </nz-form-control>
          </nz-form-item>
          <button nz-button nzType="primary" [nzLoading]="submitting" (click)="handleSubmit()">Add Comment</button>
        </nz-comment-content>
      </nz-comment>
    </form>
  </div>
</div>

